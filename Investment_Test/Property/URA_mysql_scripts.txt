================================================================================
URA_CONDORENT_HISTORY
------------------------------------------------------------
Find average yearly rental for same floor range in same project.

SELECT POSTAL_DISTRICT, PROJECT_NAME, STREET_NAME, FLOOR_AREA_LOWER, FLOOR_AREA_UPPER, ROUND(AVG(YEARLY_GROSS_RENT)) AS YEARLY_GROSS_RENT_AVG
FROM URA_CONDORENT_HISTORY
GROUP BY POSTAL_DISTRICT, PROJECT_NAME, STREET_NAME, FLOOR_AREA_LOWER, FLOOR_AREA_UPPER
ORDER BY POSTAL_DISTRICT, PROJECT_NAME, STREET_NAME, FLOOR_AREA_LOWER, FLOOR_AREA_UPPER;
================================================================================
URA_CONDOTRANS_HISTORY
------------------------------------------------------------
Find projects, which
1. price is <= s$850,000,
2. Price-to-Rent Ratio is <= 30 years.

SELECT a.POSTAL_DISTRICT, a.PROJECT_NAME, a.STREET_NAME, a.PROPERTY_TYPE, a.TENURE, a.FLOOR_AREA, a.PRICE, b.YEARLY_GROSS_RENT_AVG, ROUND(a.PRICE / b.YEARLY_GROSS_RENT_AVG) AS PRICE_RENT_RATIO
FROM
  (SELECT POSTAL_DISTRICT, PROJECT_NAME, STREET_NAME, PROPERTY_TYPE, TENURE, FLOOR_AREA, PRICE
   FROM URA_CONDOTRANS_HISTORY) a
  INNER JOIN
  (SELECT POSTAL_DISTRICT, PROJECT_NAME, FLOOR_AREA_LOWER, FLOOR_AREA_UPPER, ROUND(AVG(YEARLY_GROSS_RENT)) AS YEARLY_GROSS_RENT_AVG
   FROM URA_CONDORENT_HISTORY
   GROUP BY POSTAL_DISTRICT, PROJECT_NAME, STREET_NAME, FLOOR_AREA_LOWER, FLOOR_AREA_UPPER) b
  ON ((a.POSTAL_DISTRICT = b.POSTAL_DISTRICT)
      AND (a.PROJECT_NAME = b.PROJECT_NAME)
      AND (a.FLOOR_AREA >= b.FLOOR_AREA_LOWER)
      AND (a.FLOOR_AREA < b.FLOOR_AREA_UPPER))
WHERE (a.PRICE <= 850000)
      AND (ROUND(a.PRICE / b.YEARLY_GROSS_RENT_AVG) <= 30)
ORDER BY a.FLOOR_AREA, a.PRICE, a.POSTAL_DISTRICT, a.PROJECT_NAME
================================================================================
